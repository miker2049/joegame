{"version":3,"sources":["../../src/components/VoxBox.ts"],"names":["BOXALPHA","VoxBox","level","scene","fontSize","wordWrap","width","map","tileWidth","padding","x","y","fixedWidth","fixedHeight","setWordWrapCallback","str","wrapped","basicWordWrap","context","splitt","split","slice","textbuff","setAlpha","setBackgroundColor","setOrigin","setScale","cameras","default","zoom","speed","setMDText","open","tweens","add","targets","alpha","duration","text","updateVoxtext","setText","updateText","Phaser","GameObjects","Text"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;;;AAIA,IAAMA,QAAQ,GAAG,GAAjB;;IACqBC,M;;;;;AAGjB,kBAAYC,KAAZ,EAAqC;AAAA;;AAAA;AACjC,8BAAMA,KAAK,CAACC,KAAZ,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,EAAzB,EAA6B;AACzB;AACAC,MAAAA,QAAQ,EAAE,MAFe;AAGzBC,MAAAA,QAAQ,EAAE;AACNC,QAAAA,KAAK,EAAEJ,KAAK,CAACK,GAAN,CAAUC,SAAV,GAAsB;AADvB,OAHe;AAOzBC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,CAAC,EAAE,CAAL;AAAQC,QAAAA,CAAC,EAAE;AAAX,OAPgB;AAQzBC,MAAAA,UAAU,EAAEV,KAAK,CAACK,GAAN,CAAUC,SAAV,GAAsB,CART;AASzBK,MAAAA,WAAW,EAAEX,KAAK,CAACK,GAAN,CAAUC,SAAV,GAAsB;AATV,KAA7B;;AAWA,UAAKM,mBAAL,CAAyB,UAACC,GAAD,EAAS;AAC9B,UAAMC,OAAO,GAAG,MAAKC,aAAL,CAAmBF,GAAnB,EAAwB,MAAKG,OAA7B,EAAsChB,KAAK,CAACK,GAAN,CAAUC,SAAV,GAAsB,CAA5D,CAAhB;;AACA,UAAIW,MAAM,GAAGH,OAAO,CAACI,KAAR,CAAc,IAAd,CAAb;AACA,aAAOD,MAAM,CAACE,KAAP,CAAa,CAAC,CAAd,CAAP;AACH,KAJD;;AAKA,UAAKC,QAAL,GAAgB,EAAhB;;AACA,UAAKC,QAAL,CAAcvB,QAAd;;AACA,UAAKwB,kBAAL,CAAwB,OAAxB;;AACA,UAAKC,SAAL,CAAe,GAAf,EAAoB,CAApB;;AACA,UAAKC,QAAL,CAAc,KAAKxB,KAAK,CAACC,KAAN,CAAYwB,OAAZ,CAAoBC,OAApB,CAA4BC,IAA5B,GAAmC,CAAxC,CAAd,EArBiC,CAsBjC;;;AAtBiC;AAuBpC;;;;;2FAED,iBAAYd,GAAZ,EAAyBe,KAAzB;AAAA;AAAA;AAAA;AAAA;AACI,qBAAKC,SAAL,CAAe,EAAf;AACA,qBAAKC,IAAL;AAFJ;AAAA,uBAIU,4BAAcjB,GAAd,EAAmB,IAAnB,EAAyB,KAAKZ,KAA9B,EAAqC2B,KAArC,CAJV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;WAcA,gBAAO;AACH,WAAK3B,KAAL,CAAW8B,MAAX,CAAkBC,GAAlB,CAAsB;AAClBC,QAAAA,OAAO,EAAE,CAAC,IAAD,CADS;AAElBC,QAAAA,KAAK,EAAEpC,QAFW;AAGlBqC,QAAAA,QAAQ,EAAE;AAHQ,OAAtB;AAKH;;;WAED,iBAAQ;AACJ,WAAKlC,KAAL,CAAW8B,MAAX,CAAkBC,GAAlB,CAAsB;AAClBC,QAAAA,OAAO,EAAE,CAAC,IAAD,CADS;AAElBC,QAAAA,KAAK,EAAE,CAFW;AAGlBC,QAAAA,QAAQ,EAAE;AAHQ,OAAtB;AAKH,K,CAED;;;;WACA,mBAAUC,IAAV,EAAwB;AACpB,WAAKhB,QAAL,GAAgBgB,IAAhB;AACA,WAAKC,aAAL;AACH;;;WAED,sBAAaD,IAAb,EAA2B;AACvB,WAAKhB,QAAL,IAAiBgB,IAAjB;AACA,WAAKC,aAAL;AACH;;;WAED,6BAAoBD,IAApB,EAAkC;AAC9B,WAAKhB,QAAL,IAAiB,SAASgB,IAA1B;AACA,WAAKC,aAAL;AACH;;;WAED,yBAAgB;AACZ,WAAKC,OAAL,CAAa,KAAKlB,QAAlB;AACA,WAAKmB,UAAL;AACH;;;EA7E+BC,MAAM,CAACC,WAAP,CAAmBC,I","sourcesContent":["import 'phaser'\nimport typewriteText from '../utils/typewriteText';\nimport { ILevelComponents } from '../ILevel'\nimport { ITextBox } from './TextWindow'\n\nconst BOXALPHA = 0.7\nexport default class VoxBox extends Phaser.GameObjects.Text implements ITextBox {\n    textbuff: string\n\n    constructor(level: ILevelComponents) {\n        super(level.scene, 0, 4, '', {\n            // fontFamily: 'Retro Gaming',\n            fontSize: '12px',\n            wordWrap: {\n                width: level.map.tileWidth * 7,\n\n            },\n            padding: { x: 2, y: 2 },\n            fixedWidth: level.map.tileWidth * 7,\n            fixedHeight: level.map.tileWidth * 3.5,\n        });\n        this.setWordWrapCallback((str) => {\n            const wrapped = this.basicWordWrap(str, this.context, level.map.tileWidth * 7)\n            let splitt = wrapped.split('\\n')\n            return splitt.slice(-5)\n        })\n        this.textbuff = ''\n        this.setAlpha(BOXALPHA)\n        this.setBackgroundColor('black')\n        this.setOrigin(0.5, 1)\n        this.setScale(1 / (level.scene.cameras.default.zoom * 2))\n        // this.setMaxLines\n    }\n\n    async speak(str: string, speed?: number) {\n        this.setMDText('')\n        this.open()\n\n        await typewriteText(str, this, this.scene, speed)\n        // this.setText(str)\n        // this.scene.time.addEvent({\n        //     delay: 3500,\n        //     callback: () => {\n        //         this.close()\n        //     }\n        // })\n    }\n\n    open() {\n        this.scene.tweens.add({\n            targets: [this],\n            alpha: BOXALPHA,\n            duration: 500\n        })\n    }\n\n    close() {\n        this.scene.tweens.add({\n            targets: [this],\n            alpha: 0,\n            duration: 500\n        })\n    }\n\n    //TODO stop lying about this\n    setMDText(text: string) {\n        this.textbuff = text\n        this.updateVoxtext()\n    }\n\n    appendMDText(text: string) {\n        this.textbuff += text\n        this.updateVoxtext()\n    }\n\n    appendNewLineMDText(text: string) {\n        this.textbuff += \"\\n\\n\" + text\n        this.updateVoxtext()\n    }\n\n    updateVoxtext() {\n        this.setText(this.textbuff)\n        this.updateText()\n    }\n}\n"],"file":"VoxBox.js"}