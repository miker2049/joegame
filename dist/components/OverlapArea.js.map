{"version":3,"sources":["../../src/components/OverlapArea.ts"],"names":["OverlapArea","scenemap","x","y","t_obj","cb_","getData","callback","scene","events","emit","addListener","name","activateOverlap","player","on","overlap_id","playAnim","physics","world","enableBody","setDisplaySize","tiledWidth","tiledHeight","setSize","add","overlap","colliders","getActive","find","i","destroy","setVisible","MapObject"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;;;IAIqBA,W;;;;;AAEjB,uBAAaC,QAAb,EAAiCC,CAAjC,EAA4CC,CAA5C,EAAuDC,KAAvD,EAAoG;AAAA;;AAAA;AAChG,8BAAMH,QAAN,EAAgBC,CAAhB,EAAmBC,CAAnB,EAAsBC,KAAtB;AADgG,2FAmC/E,YAAM,CAAE,CAnCuE;;AAEhG,QAAMC,GAAG,GAAG,MAAKC,OAAL,CAAa,IAAb,CAAZ;;AAEA,QAAID,GAAJ,EAAS;AACL,YAAKE,QAAL,GAAgB,YAAI;AAAC,cAAKC,KAAL,CAAWC,MAAX,CAAkBC,IAAlB,CAAuBL,GAAvB;AAA4B,OAAjD;AACH,KAFD,MAEO,CACH;AACH;;AAED,UAAKG,KAAL,CAAWC,MAAX,CAAkBE,WAAlB,oBAA0CP,KAAK,CAACQ,IAAhD,GAAuD,YAAI;AAAC,YAAKC,eAAL,CAAqB,MAAKL,KAAL,CAAWM,MAAhC;AAAwC,KAApG;;AAEA,QAAG,MAAKR,OAAL,CAAa,QAAb,CAAH,EAA0B;AACtB,YAAKE,KAAL,CAAWC,MAAX,CAAkBM,EAAlB,CAAqB,QAArB,EAA8B,YAAI;AAC9B,cAAKF,eAAL,CAAqB,MAAKL,KAAL,CAAWM,MAAhC;AACH,OAFD;AAGH;;AAhB+F;AAiBnG;;;;WAED,yBAAgBA,MAAhB,EAAkC;AAAA;;AAC9B,UAAME,UAAU,GAAG,KAAKJ,IAAxB;AACA,WAAKK,QAAL;AACA,WAAKT,KAAL,CAAWU,OAAX,CAAmBC,KAAnB,CAAyBC,UAAzB,CAAoC,IAApC;AACA,WAAKC,cAAL,CAAoB,KAAKC,UAAzB,EAAoC,KAAKC,WAAzC;AACA,WAAKC,OAAL,CAAa,KAAKF,UAAlB,EAA6B,KAAKC,WAAlC;AACA,WAAKf,KAAL,CAAWU,OAAX,CAAmBO,GAAnB,CAAuBC,OAAvB,CAA+B,IAA/B,EAAqCZ,MAArC,EAA6C,YAAI;AAC7C,QAAA,MAAI,CAACN,KAAL,CAAWU,OAAX,CAAmBC,KAAnB,CAAyBQ,SAAzB,CAAmCC,SAAnC,GAA+CC,IAA/C,CAAoD,UAASC,CAAT,EAAW;AAC3D,iBAAOA,CAAC,CAAClB,IAAF,IAAUI,UAAjB;AACH,SAFD,EAEIe,OAFJ;;AAGA,QAAA,MAAI,CAACC,UAAL,CAAgB,KAAhB;;AACA,QAAA,MAAI,CAACzB,QAAL;;AACA,QAAA,MAAI,CAACwB,OAAL;AACH,OAPD,EAOE,YAAI,CAAE,CAPR,EAOS,KAAKvB,KAPd,EAOqBI,IAPrB,GAO4BI,UAP5B;AAQH;;;EAnCoCiB,mB","sourcesContent":["import 'phaser';\nimport MapObject from './MapObject';\nimport Character from './Character';\nimport SceneMap from './SceneMap';\n\nexport default class OverlapArea extends MapObject {\n\n    constructor( scenemap: SceneMap, x: number, y: number, t_obj: Phaser.Types.Tilemaps.TiledObject  )  {\n        super(scenemap, x, y, t_obj);\n        const cb_ = this.getData('cb');\n\n        if (cb_) {\n            this.callback = ()=>{this.scene.events.emit(cb_)}\n        } else {\n            // console.log(\"No callback defined for overlap area ${this.name}\");\n        }\n\n        this.scene.events.addListener(`activate_${t_obj.name}`,()=>{this.activateOverlap(this.scene.player)});\n\n        if(this.getData(\"active\")){\n            this.scene.events.on('create',()=>{\n                this.activateOverlap(this.scene.player);\n            })\n        }\n    }\n\n    activateOverlap(player: Character){\n        const overlap_id = this.name;\n        this.playAnim()\n        this.scene.physics.world.enableBody(this);\n        this.setDisplaySize(this.tiledWidth,this.tiledHeight)\n        this.setSize(this.tiledWidth,this.tiledHeight);\n        this.scene.physics.add.overlap(this, player, ()=>{\n            this.scene.physics.world.colliders.getActive().find(function(i){\n                return i.name == overlap_id;\n            })!.destroy();\n            this.setVisible(false);\n            this.callback();\n            this.destroy();\n        },()=>{},this.scene).name = overlap_id;\n    }\n\n    callback: Function = () => {}\n}\n"],"file":"OverlapArea.js"}