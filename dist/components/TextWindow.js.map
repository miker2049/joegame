{"version":3,"sources":["../../src/components/TextWindow.ts"],"names":["TextWindow","data","style","width","height","phaserDom","add","dom","x","y","additionalStyle","setOrigin","text","setMDText","input","keyboard","enabled","alpha","on","event","key","close","tweens","targets","duration","textBuff","updateHTML","setHTML","Phaser","Scene"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;;;IAmBqBA,U;;;;;;;;;;;;;;;2FAEE,E;;;;;;WAEnB,cAAKC,IAAL,EAA2B;AAAA;AAAA;AAAA;AAAA;;AACvB,UAAMC,KAAK,oJAGED,IAAI,CAACE,KAHP,qDAGgB,GAHhB,kLAQGF,IAAI,CAACG,MARR,uDAQkB,GARlB,oFAAX;AAWA,WAAKC,SAAL,GAAiB,KAAKC,GAAL,CAASC,GAAT,CAAaN,IAAI,CAACO,CAAlB,EAAqBP,IAAI,CAACQ,CAA1B,EAA6B,KAA7B,UAAoCP,KAAK,GAAGD,IAAI,CAACS,eAAjD,uCAAoE,EAApE,EAAwEC,SAAxE,CAAkF,CAAlF,EAAqF,CAArF,CAAjB;;AACA,UAAIV,IAAI,CAACW,IAAT,EAAe;AACX,aAAKC,SAAL,CAAeZ,IAAI,CAACW,IAApB;AACH;;AAED,WAAKE,KAAL,CAAWC,QAAX,CAAoBC,OAApB,GAA8B,IAA9B;AACA,WAAKX,SAAL,CAAeY,KAAf,GAAuB,CAAvB;AAEA,WAAKH,KAAL,CAAWC,QAAX,CAAoBG,EAApB,CAAuB,OAAvB,EAAgC,UAACC,KAAD,EAA0B;AACtD,YAAIA,KAAK,CAACC,GAAN,KAAc,OAAd,IAAyBD,KAAK,CAACC,GAAN,KAAc,QAA3C,EAAqD;AACjD,UAAA,MAAI,CAACC,KAAL;AACH;AACJ,OAJD;AAKH;;;WAED,gBAAO;AACH,WAAKC,MAAL,CAAYhB,GAAZ,CAAgB;AACZiB,QAAAA,OAAO,EAAE,CAAC,KAAKlB,SAAN,CADG;AAEZY,QAAAA,KAAK,EAAE,CAFK;AAGZO,QAAAA,QAAQ,EAAE;AAHE,OAAhB;AAKH;;;WACD,iBAAQ;AACJ,WAAKV,KAAL,CAAWC,QAAX,CAAoBC,OAApB,GAA8B,KAA9B;AAEA,WAAKM,MAAL,CAAYhB,GAAZ,CAAgB;AACZiB,QAAAA,OAAO,EAAE,CAAC,KAAKlB,SAAN,CADG;AAEZY,QAAAA,KAAK,EAAE,CAFK;AAGZO,QAAAA,QAAQ,EAAE;AAHE,OAAhB;AAKH;;;WACD,mBAAUZ,IAAV,EAAwB;AACpB,WAAKa,QAAL,GAAgBb,IAAhB;AACA,WAAKc,UAAL;AACH;;;WACD,sBAAad,IAAb,EAA2B;AACvB,WAAKa,QAAL,IAAiBb,IAAjB;AACA,WAAKc,UAAL;AACH;;;WACD,6BAAoBd,IAApB,EAAkC;AAC9B,WAAKa,QAAL,IAAiB,SAASb,IAA1B;AACA,WAAKc,UAAL;AACH;;;WACD,sBAA2B;AAAE,WAAKrB,SAAL,CAAesB,OAAf,CAAuB,sBAAQ,KAAKF,QAAb,CAAvB;AAAgD;;;EA3DzCG,MAAM,CAACC,K","sourcesContent":["import 'phaser'\nimport mdParse from '../utils/mdParse'\n\nexport interface TextWindowData {\n    x: number\n    y: number\n    height?: number\n    width?: number\n    text?: string\n    additionalStyle?: string\n}\n\nexport interface ITextBox {\n    open(): void\n    close(): void\n    setMDText(text: string): void\n    appendMDText(text: string): void\n    appendNewLineMDText(text: string): void\n}\n\nexport default class TextWindow extends Phaser.Scene implements ITextBox {\n    phaserDom!: Phaser.GameObjects.DOMElement\n    textBuff: string = ''\n\n    init(data: TextWindowData) {\n        const style = ` list-style: none;\n             background-color: rgba(0,0,0,0.8);\n             overflow: hidden;\n             width:${data.width ?? 250}px;\n             margin: 0px;\n             padding: 1em;\n             color: white;\n             font-family: Retro Gaming;\n             height:${data.height ?? 250}px;\n             -ms-overflow-style:none;\n             scrollbar-width: none;`\n        this.phaserDom = this.add.dom(data.x, data.y, 'div', style + data.additionalStyle ?? '').setOrigin(0, 0)\n        if (data.text) {\n            this.setMDText(data.text)\n        }\n\n        this.input.keyboard.enabled = true;\n        this.phaserDom.alpha = 0;\n\n        this.input.keyboard.on('keyup', (event: KeyboardEvent) => {\n            if (event.key === 'Enter' || event.key === 'Escape') {\n                this.close();\n            }\n        })\n    }\n\n    open() {\n        this.tweens.add({\n            targets: [this.phaserDom],\n            alpha: 1,\n            duration: 500\n        })\n    }\n    close() {\n        this.input.keyboard.enabled = false;\n\n        this.tweens.add({\n            targets: [this.phaserDom],\n            alpha: 0,\n            duration: 500\n        })\n    }\n    setMDText(text: string) {\n        this.textBuff = text\n        this.updateHTML()\n    }\n    appendMDText(text: string) {\n        this.textBuff += text\n        this.updateHTML()\n    }\n    appendNewLineMDText(text: string) {\n        this.textBuff += \"\\n\\n\" + text\n        this.updateHTML()\n    }\n    private updateHTML(): void { this.phaserDom.setHTML(mdParse(this.textBuff)) }\n}\n"],"file":"TextWindow.js"}